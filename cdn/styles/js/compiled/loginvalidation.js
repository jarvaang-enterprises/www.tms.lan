var current_fs,next_fs,previous_fs,left,opacity,scale,old_width=0,new_width,animating,ref=null;$("#email").val("");function setref(a){ref=a}$(".next").click(function(){current_fs=$(this).parent();var a=$("fieldset").index(current_fs);if(0==a){$("#password").val("");$("#msg").text("");var b=$("#email").val();checkEmail(b,function(a){1==a&&(next_fs=current_fs.next(),animate(next_fs))})}1==a&&(next_fs=current_fs.next(),animate(next_fs))});
function animate(a){log("Animating...");if(animating)return!1;animating=!0;$(".progressbar .bar").animate({height:"5px",width:old_width+145});a.show();$(".login").animate({height:"370px"});current_fs.animate({opacity:0},{step:function(b,d){left=-10*b+"%";opacity=1-b;current_fs.css({transform:"scale("+scale+")"});a.css({left:left,opacity:opacity});a.css({"margin-top":"10px","margin-left":"10px"})},duration:200,complete:function(){current_fs.hide();animating=!1},easing:"easeInOutBack"})}
$(".previous").click(function(){if(animating)return!1;animating=!0;current_fs=$(this).parent();previous_fs=$(this).parent().prev();$(".progressbar .bar").animate({width:"1%"});previous_fs.show();$(".login").animate({height:"300px"});$("#error_msg").text("");current_fs.animate({opacity:0},{step:function(a,b){scale=.8+.2*(1-a);left=20*(1-a)+"%";opacity=1-a;current_fs.css({left:left});previous_fs.css({transform:"scale("+scale+")",opacity:opacity})},duration:200,complete:function(){current_fs.hide();
animating=!1},easing:"easeInOutBack"})});checkAuthentication();
function checkAuthentication(){$("#msform").on("submit",function(a){a.preventDefault();$.ajax({url:"/actions/checkAuth.php",type:"POST",data:new FormData(this),contentType:!1,cache:!0,dataType:"JSON",processData:!1,success:function(a){"SHOW_ERROR"==a.action?($(".login").animate({height:"410px"}),$("#password").css({"border-color":"#dd4b39"}),$("#password").focus(),$("#msg").css({color:"#dd4b39","text-align":"left"}),$("#msg").text(a.msg)):"SHOW_SUCCESS"==a.action&&(null!=ref?window.location.href=
ref:1==a.level?window.location.href="/man/":2==a.level?window.location.href="/csh/":3==a.level?window.location.href="/trn/":4==a.level&&(window.location.href="/cli/"))},error:function(){log("Errors occured: In authentication.")}})})}
function checkEmail(a,b){$.ajax({url:"/actions/checkEmail.php",type:"POST",dataType:"JSON",data:"user="+a,success:function(a){if("SHOW_ERROR"==a.action){$(".login").animate({height:"330px"});$("#email").css({"border-color":"#dd4b39"});$("#email").focus();$("#error_msg").text(a.error_msg);var c=0}else"SHOW_SUCCESS"==a.action&&($("#img").html(a.image),$("#userName").text(a.fName+" "+a.lName),$("#userEmail").text(a.email),c=1);b(c)},error:function(){log("Error occured: In checking email."+a)}})};
